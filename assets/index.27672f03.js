var I=Object.defineProperty;var k=(r,e,t)=>e in r?I(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var c=(r,e,t)=>(k(r,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const L=Vue.defineComponent({__name:"App",setup(r){return(e,t)=>(Vue.openBlock(),Vue.createBlock(Vue.unref(VueRouter.RouterView)))}});var y={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(r){(function(){var e={}.hasOwnProperty;function t(){for(var i=[],n=0;n<arguments.length;n++){var s=arguments[n];if(!!s){var o=typeof s;if(o==="string"||o==="number")i.push(s);else if(Array.isArray(s)){if(s.length){var u=t.apply(null,s);u&&i.push(u)}}else if(o==="object"){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){i.push(s.toString());continue}for(var l in s)e.call(s,l)&&s[l]&&i.push(l)}}}return i.join(" ")}r.exports?(t.default=t,r.exports=t):window.classNames=t})()})(y);const S=y.exports,b=[[-1,0],[0,1],[1,0],[0,-1]],v=[...b,[-1,1],[1,1],[1,-1],[-1,-1]],d=10,f=10,V=20,g=9,a={INIT:0,PLAYING:1,SUCCESS:2,FAIL:3},p={E:"E",M:"M",H:"H"},w={[p.E]:{rows:8,cols:8,name:"\u7B80\u5355",count:10},[p.M]:{rows:16,cols:16,name:"\u4E2D\u7B49",count:40},[p.H]:{rows:16,cols:30,name:"\u56F0\u96BE",count:99}};class C{constructor(e){c(this,"rows");c(this,"cols");c(this,"count");c(this,"countdown");c(this,"flagged");c(this,"level");c(this,"plowed");c(this,"grid");c(this,"state");c(this,"opts");const{level:t}=e,{rows:i,cols:n,count:s}=w[t];this.rows=i,this.cols=n,this.count=s,this.level=e.level,this.opts=e,this.reset()}getPosition(e){return[Math.floor(e/this.cols),e%this.cols]}getMapKey([e,t]){return e*this.cols+t}init(e){const t=new Map,i=this.rows*this.cols;let n=0;for(this.checkNear(e,s=>{const o=this.getMapKey(s);t.set(o,!0)});n<this.count;){const s=Math.floor(Math.random()*i);if(!t.has(s)){const[o,u]=this.getPosition(s);if(t.set(s,!0),o===e[0]&&u===e[1])continue;this.grid[o][u]+=g,n+=1}}this.compute()}compute(){for(let e=0;e<this.rows;++e)for(let t=0;t<this.cols;++t)if(!this.isMine(e,t))for(const[i,n]of v){const s=e+i,o=t+n;this.inArea(s,o)&&this.isMine(s,o)&&(this.grid[e][t]+=1)}}reset(){this.grid=new Array(this.rows).fill(0).map(()=>new Array(this.cols).fill(f)),this.state=a.INIT,this.plowed=0,this.countdown=0,this.flagged=0}start(e){this.init(e),this.showNoMineArea(e),this.state=a.PLAYING}fail(){var e,t;(t=(e=this.opts).fail)==null||t.call(e),this.showMine(),this.state=a.FAIL}success(){var e,t;(t=(e=this.opts).success)==null||t.call(e),this.state=a.SUCCESS}showNoMineArea(e){const t=[e];for(;t.length;){const[i,n]=t.shift();this.isMask(i,n)&&(this.grid[i][n]-=d),this.checkNear([i,n],([s,o])=>{this.isEmpty(s,o)&&t.push([s,o]),this.isMask(s,o)&&!this.isMine(s,o)&&(this.grid[s][o]-=d)})}this.tryToEnd()}showMine(){this.mapGrid(([e,t])=>{this.isMine(e,t)&&(this.grid[e][t]%=d)})}checkNear(e,t){const[i,n]=e;for(const s of v){const[o,u]=[i+s[0],n+s[1]];this.inArea(o,u)&&t([o,u])}}tryToEnd(){if(this.plowed!==this.count)return;let e=0;this.mapGrid(([t,i])=>{this.isMask(t,i)&&(e+=1)}),e===0&&this.success()}mapGrid(e){for(let t=0;t<this.rows;++t)for(let i=0;i<this.cols;++i)e([t,i])}clickItem(e){const[t,i]=e;if(this.state===a.INIT){this.start(e);return}if(this.grid[t][i]>=f)if(this.isMine(t,i)){this.fail();return}else this.showNoMineArea(e);else{let n=0;this.checkNear(e,([s,o])=>{this.isFlag(s,o)&&(n+=1)}),n===this.grid[t][i]&&this.showNoMineArea(e)}}markItem(e){const[t,i]=e;this.isPlowed(t,i)||(this.isMask(t,i)?(this.isMine(t,i)&&(this.plowed+=1),this.flagged+=1,this.grid[t][i]+=d,this.tryToEnd()):(this.isMine(t,i)&&(this.plowed-=1),this.flagged-=1,this.grid[t][i]-=d))}inArea(e,t){return e>=0&&e<this.rows&&t>=0&&t<this.cols}isPlowed(e,t){return this.grid[e][t]<f}isMask(e,t){return this.grid[e][t]>=f&&this.grid[e][t]<V}isFlag(e,t){return this.grid[e][t]>V}isEmpty(e,t){return this.grid[e][t]===f}isMine(e,t){return this.grid[e][t]%d===g}}function T(r){return new C(r)}const P="_box_dui1x_1",F="_menu_dui1x_8",D="_btn_dui1x_19",B="_field_dui1x_33",R="_item_dui1x_41",G="_mask_dui1x_56",h={box:P,menu:F,btn:D,field:B,item:R,mask:G,"item-0":"_item-0_dui1x_60","item-1":"_item-1_dui1x_64","item-2":"_item-2_dui1x_68","item-3":"_item-3_dui1x_72","item-4":"_item-4_dui1x_76","item-5":"_item-5_dui1x_80","item-6":"_item-6_dui1x_84","item-7":"_item-7_dui1x_88","item-8":"_item-8_dui1x_92"},O={count:Number,status:{default:a.INIT,type:Number,required:!0},time:{default:0,type:Number},onChangeLevel:Function,onReset:Function},j={[a.INIT]:128578,[a.PLAYING]:128578,[a.FAIL]:128534,[a.SUCCESS]:128526},K=Vue.defineComponent({name:"MenuBar",props:O,emits:["changeLevel","reset"],setup(r,{emit:e}){const t=Object.keys(w);function i(o){e("changeLevel",o)}function n(){e("reset")}function s(o){const u=String(o);return String.fromCodePoint(j[u])}return()=>{const{count:o,status:u,time:l}=r;return Vue.createVNode("header",null,[Vue.createVNode("div",{class:h.menu},[t.map((m,_)=>Vue.createVNode("div",{key:_,onClick:()=>i(m)},[w[m].name]))]),Vue.createVNode("div",{class:h.menu},[Vue.createVNode("div",null,[o]),Vue.createVNode("div",{class:h.btn,onClick:n},[s(u)]),Vue.createVNode("div",null,[l])]),Vue.createVNode("div",null,null)])}}}),H=Vue.defineComponent({name:"minisweeper",setup(){const r=Vue.ref();function e(s){r.value=T({level:s})}function t(s,o){var u;(u=r.value)==null||u.clickItem([s,o])}function i(s,o,u){var l;s.preventDefault(),(l=r.value)==null||l.markItem([o,u])}function n(s){return s===g?Vue.createVNode(Vue.Fragment,null,[Vue.createTextVNode("\u{1F4A3}")]):s>=V?Vue.createVNode(Vue.Fragment,null,[Vue.createTextVNode("\u{1F6A9}")]):s<f?Vue.createVNode("span",{class:S(h.item,h[`item-${s}`])},[s]):Vue.createVNode("span",null,null)}return Vue.onMounted(()=>{e(p.E)}),()=>{const{level:s,state:o,count:u,flagged:l}=r.value||{},m=(u||0)-(l||0);return r.value?Vue.createVNode("div",{class:h.box},[Vue.createVNode(K,{count:m,level:s,status:o,onChangeLevel:e,onReset:()=>e(s)},null),Vue.createVNode("div",null,[r.value.grid.map((_,N)=>Vue.createVNode("div",{class:h.field},[_.map((x,M)=>Vue.createVNode("div",{class:h.btn,onClick:()=>t(N,M),onContextmenu:A=>i(A,N,M)},[n(x)]))]))])]):null}}}),Y=VueRouter.createRouter({history:VueRouter.createWebHistory("/game-box/"),routes:[{path:"/",name:"minesweeper",component:H}]}),E=Vue.createApp(L);E.use(Y);E.mount("#app");
